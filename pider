#!/bin/php7.1
<?php

function runPider($classpath) {
    define('PIDER_PATH',__DIR__.'/src'); 
    if(!file_exists($classpath)){
        exit('Error: File not exists!');
    } else {
        include_once(PIDER_PATH.'/Pider.php');
        chdir(dirname($classpath));
        $classfile = basename($classpath);
        include_once($classpath);
        $classname  = basename($classpath,'.php');
        $cls = new $classname();
        $cls->go();
    }
}

if (PHP_SAPI != 'cli') {
    exit('This command must be run under cli!');
} else {
    if ( $argc != 2  ) {
        exit("pider [classname] ".PHP_EOL.
        "   Run a pider...".PHP_EOL);
    }
    runPider($argv[1]);
}
